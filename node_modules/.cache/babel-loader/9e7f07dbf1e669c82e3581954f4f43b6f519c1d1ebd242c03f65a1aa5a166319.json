{"ast":null,"code":"import React,{useEffect,useState}from'react';import Popup from'reactjs-popup';import'./ReviewTable.css';import GiveReviews from'./GiveReviews';import{useLocation,useNavigate}from\"react-router-dom\";//decoy doctor data - to be replaced with an approriate API endpoint\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const doctors=[{id:1,name:'Dr. Zela Lee',specialty:'General Physician'},{id:2,name:'Dr. Williams Huang',specialty:'Dentist'},{id:3,name:'Dr. Smith Johnson',specialty:'Cardiology'},{id:4,name:'Dr. Lena Chow',specialty:'Dermatology'},{id:5,name:'Dr. Apu Ali',specialty:'Homeopath'}];const ReviewTable=()=>{//set initial states \nconst[reviewData,setReviewData]=useState({});//empty data object passed onto feedback modal\nconst[completedReview,setCompletedReview]=useState({});// Track completed reviews\nconst[chosenDoctor,setChosenDoctor]=useState(null);// Track which doctor is selected; doctor's ID\nconst[showForm,setShowForm]=useState(false);// Add state to control form visibility\nconst[name,setName]=useState('');const[email,setEmail]=useState('');// Check if we're on the /review route\nconst location=useLocation();// Get current route\nconst navigate=useNavigate();const isReviewPage=location.pathname===\"/review\";// to handle if user has login successfully, else reroute to login\nuseEffect(()=>{const storedName=sessionStorage.getItem(\"name\");const storedEmail=sessionStorage.getItem(\"email\");//if not successfully login, navigate to /login endpoint\nif(storedName){setName(storedName);setEmail(storedEmail);}else{navigate(\"/login\");}},[]);//prop to be passed onto GiveReviews component\nconst handleGiveReview=serialNumber=>{setChosenDoctor(serialNumber);setCompletedReview(prevState=>({...prevState,id:serialNumber,ratings:0,review:\"\"}));setReviewData(prevReviewData=>({...prevReviewData,[serialNumber]:''}));};//\nconst handleReviewSubmit=(serialNumber,formData)=>{setReviewData(prevReviewData=>({...prevReviewData,[serialNumber]:formData}));setCompletedReview(prev=>({...prev,[serialNumber]:{ratings:formData.rating,review:formData.review}}));};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"reviews-container\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\" Reviews \",/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"review-table\",children:[/*#__PURE__*/_jsxs(\"thead\",{children:[\" \",/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"S/No.\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Doctor name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Doctor specialty\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Provide review\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Review given\"})]})]}),/*#__PURE__*/_jsx(\"tbody\",{children:doctors.map(doctor=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:doctor.id}),/*#__PURE__*/_jsx(\"td\",{children:doctor.name}),/*#__PURE__*/_jsx(\"td\",{children:doctor.specialty}),/*#__PURE__*/_jsx(\"td\",{children:!completedReview[doctor.id]?/*#__PURE__*/_jsx(Popup,{contentStyle:{width:'33%',height:'auto',borderRadius:\"0.5rem\"},trigger:/*#__PURE__*/_jsx(\"button\",{className:\"review-btn\",onClick:()=>handleGiveReview(doctor.id),disabled:completedReview[doctor.id]&&completedReview[doctor.id].ratings>0&&completedReview[doctor.id].remarks.length>0,children:\"Give Review \"}),modal:true,nested:true,children:close=>/*#__PURE__*/_jsxs(\"div\",{className:\"feedback-modal\",children:[/*#__PURE__*/_jsx(GiveReviews,{serialNumber:doctor.id,onReviewSubmit:(serialNumber,formData)=>{handleReviewSubmit(serialNumber,formData);close();// Close the modal after submission\n},review:reviewData[doctor.id]// Pass the review data\n,onSubmit:close}),/*#__PURE__*/_jsx(\"button\",{className:\"close-btn\",onClick:close,children:\"Close \"})]})}):/*#__PURE__*/_jsx(\"button\",{className:\"review-btn\",disabled:true,children:\" Give review \"})}),/*#__PURE__*/_jsxs(\"td\",{children:[\" \",completedReview[doctor.id]&&/*#__PURE__*/_jsxs(\"div\",{children:[\"Rating: \",completedReview[doctor.id].ratings,\"/5 \",/*#__PURE__*/_jsx(\"br\",{}),\"\\\"\",completedReview[doctor.id].review,\"\\\"\"]})]})]},doctor.id))})]})]})});};export default ReviewTable;","map":{"version":3,"names":["React","useEffect","useState","Popup","GiveReviews","useLocation","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","doctors","id","name","specialty","ReviewTable","reviewData","setReviewData","completedReview","setCompletedReview","chosenDoctor","setChosenDoctor","showForm","setShowForm","setName","email","setEmail","location","navigate","isReviewPage","pathname","storedName","sessionStorage","getItem","storedEmail","handleGiveReview","serialNumber","prevState","ratings","review","prevReviewData","handleReviewSubmit","formData","prev","rating","children","className","map","doctor","contentStyle","width","height","borderRadius","trigger","onClick","disabled","remarks","length","modal","nested","close","onReviewSubmit","onSubmit"],"sources":["C:/Users/lim_l/Documents/progamming/032-grihf-frontend_capstone_starter_code/src/Components/reviewform/ReviewTable.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport Popup from 'reactjs-popup';\r\nimport './ReviewTable.css';\r\nimport GiveReviews from './GiveReviews';\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\n\r\n//decoy doctor data - to be replaced with an approriate API endpoint\r\nconst doctors = [\r\n  { id: 1, name: 'Dr. Zela Lee', specialty: 'General Physician' },\r\n  { id: 2, name: 'Dr. Williams Huang', specialty: 'Dentist' },\r\n  { id: 3, name: 'Dr. Smith Johnson', specialty: 'Cardiology' },\r\n  { id: 4, name: 'Dr. Lena Chow', specialty: 'Dermatology' },\r\n  { id: 5, name: 'Dr. Apu Ali', specialty: 'Homeopath' }\r\n];\r\n\r\n\r\nconst ReviewTable = () => {\r\n  //set initial states \r\n  const [reviewData, setReviewData] = useState({}); //empty data object passed onto feedback modal\r\n  const [completedReview, setCompletedReview] = useState({}); // Track completed reviews\r\n  const [chosenDoctor, setChosenDoctor] = useState(null); // Track which doctor is selected; doctor's ID\r\n  const [showForm, setShowForm] = useState(false); // Add state to control form visibility\r\n  const [name, setName] = useState('');\r\n  const [email, setEmail] = useState('');\r\n\r\n  // Check if we're on the /review route\r\n  const location = useLocation(); // Get current route\r\n  const navigate = useNavigate();\r\n  const isReviewPage = location.pathname === \"/review\";\r\n\r\n  // to handle if user has login successfully, else reroute to login\r\nuseEffect ( () => {\r\n   \r\n  const storedName = sessionStorage.getItem(\"name\");\r\n  const storedEmail = sessionStorage.getItem(\"email\");\r\n\r\n  //if not successfully login, navigate to /login endpoint\r\n  if (storedName) {\r\n       setName(storedName) ;\r\n       setEmail(storedEmail);\r\n  } else {\r\n       navigate(\"/login\");\r\n  }\r\n\r\n},  []);\r\n\r\n  //prop to be passed onto GiveReviews component\r\n  const handleGiveReview = (serialNumber) => {\r\n    setChosenDoctor(serialNumber);\r\n    setCompletedReview( prevState => ({\r\n      ...prevState,\r\n      id: serialNumber, \r\n      ratings:0,\r\n      review:\"\",\r\n    }));\r\n\r\n    setReviewData((prevReviewData) => ({ ...prevReviewData, [serialNumber]: ''}));\r\n    };\r\n\r\n  //\r\n  const handleReviewSubmit = (serialNumber, formData) => {\r\n        setReviewData((prevReviewData) => ({ ...prevReviewData, [serialNumber]: formData }));\r\n        setCompletedReview( (prev) => ({\r\n          ...prev,\r\n          [serialNumber]: {\r\n            ratings:formData.rating,\r\n            review: formData.review,\r\n          }\r\n        }) )\r\n   };\r\n\r\n\r\n\r\nreturn ( \r\n<>\r\n  <div className=\"reviews-container\">\r\n  <h1> Reviews <br/></h1> \r\n\r\n  <table className=\"review-table\">\r\n    <thead> <tr>\r\n      <th>S/No.</th>\r\n      <th>Doctor name</th>\r\n      <th>Doctor specialty</th>\r\n      <th>Provide review</th>\r\n      <th>Review given</th>\r\n    </tr></thead>\r\n\r\n    <tbody>\r\n    {doctors.map(doctor => (\r\n      <tr key={doctor.id}>\r\n        <td>{doctor.id}</td>\r\n        <td>{doctor.name}</td>\r\n        <td>{doctor.specialty}</td>\r\n        <td>           \r\n          { !completedReview[doctor.id] ? (\r\n          <Popup contentStyle={{ width: '33%', height: 'auto', borderRadius:\"0.5rem\" }} trigger={ \r\n            <button className=\"review-btn\"\r\n              onClick={() => handleGiveReview(doctor.id)} \r\n              disabled = {completedReview[doctor.id] && completedReview[doctor.id].ratings >0 \r\n                           && completedReview[doctor.id].remarks.length >0 }\r\n              >\r\n                Give Review </button>\r\n              }  modal nested\r\n            >\r\n\r\n            {(close) => (  \r\n                  <div className=\"feedback-modal\">\r\n                    <GiveReviews\r\n                        serialNumber={doctor.id}\r\n                        onReviewSubmit={(serialNumber, formData) => {\r\n                          handleReviewSubmit(serialNumber, formData);\r\n                          close(); // Close the modal after submission\r\n                        }}\r\n                        review={reviewData[doctor.id]} // Pass the review data\r\n                        onSubmit={close}\r\n                    />\r\n                    <button className=\"close-btn\" onClick={close}>\r\n                      Close </button>\r\n                  </div>\r\n                  )}\r\n            </Popup>\r\n              ):( \r\n              <button className=\"review-btn\" disabled> Give review </button>\r\n              )\r\n          }\r\n        </td>\r\n        <td> {completedReview[doctor.id] && (\r\n            <div>\r\n              Rating: {completedReview[doctor.id].ratings}/5 <br />\r\n              \"{completedReview[doctor.id].review}\"\r\n            </div>\r\n          )}\r\n        </td>\r\n      </tr>\r\n    ))}\r\n    </tbody>\r\n  </table>\r\n\r\n    \r\n\r\n\r\n </div> \r\n </> \r\n \r\n);\r\n}\r\n\r\nexport default ReviewTable;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}